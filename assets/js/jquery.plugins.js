function createCookie(e,t,a){if(a){var r=new Date;r.setTime(r.getTime()+24*a*60*60*1e3);var n="; expires="+r.toGMTString()}else var n="";document.cookie=e+"="+t+n+"; path=/"}function create_message(e,t,a){return messages[e]={},jQuery("#messages").append("<div onClick='delete_message(\""+e+"\")' class='message "+e+"' style='display:none'>"+a+"</div>"),jQuery("#messages ."+e).fadeIn(500),0!=t&&(messages[e].timeout=setTimeout('delete_message("'+e+'")',t)),!1}function delete_message(e){return void 0!=messages[e]&&clearTimeout(messages[e].timeout),jQuery("#messages ."+e).fadeOut(500,function(){jQuery("#messages ."+e).remove()}),!1}!function(){function e(e){e=e||window.event;for(var s,u,l,c=e.target||e.srcElement;c&&"a"!==c.nodeName.toLowerCase();)c=c.parentNode;c&&"a"===c.nodeName.toLowerCase()&&c.href&&(s=c.href.match(t),s&&(u=Math.round(i/2-r/2),l=0,o>n&&(l=Math.round(o/2-n/2)),window.open(c.href,"intent",a+",width="+r+",height="+n+",left="+u+",top="+l),e.returnValue=!1,e.preventDefault&&e.preventDefault()))}if(!window.__twitterIntentHandler){var t=/twitter\.com(\:\d{2,4})?\/intent\/(\w+)/,a="scrollbars=yes,resizable=yes,toolbar=no,location=yes",r=550,n=420,o=screen.height,i=screen.width;document.addEventListener?document.addEventListener("click",e,!1):document.attachEvent&&document.attachEvent("onclick",e),window.__twitterIntentHandler=!0}}();var messages=[];!function(e){var t=e.preload=function(a,r){function n(n){u.element=this,u.found="load"==n.type,u.image=this.src,u.index=this.index;var s=u.original=a[this.index];u[u.found?"loaded":"failed"]++,u.done++,r.enforceCache&&t.cache.push(e("<img/>").attr("src",u.image)[0]),r.placeholder&&s.src&&(s.src=u.found?u.image:r.notFound||s.src),r.onComplete&&r.onComplete(u),u.done<u.total?o(0,this):(l&&l.unbind&&l.unbind("load").unbind("error").unbind("abort"),l=null,i())}function o(e,n,i){return n.attachEvent&&u.next&&u.next%t.gap==0&&!i?(setTimeout(function(){o(e,n,1)},0),!1):u.next==u.total?!1:(n.index=u.next,n.src=s[u.next++],void(r.onRequest&&(u.index=n.index,u.element=n,u.image=n.src,u.original=a[u.next-1],r.onRequest(u))))}function i(){r.onFinish&&r.onFinish(u)}a.split&&(a=e(a)),r=e.extend({},t.defaults,r);var s=e.map(a,function(e){if(e){if(e.split)return r.base+e+r.ext;var t=e.src||e.href;return"string"==typeof r.placeholder&&e.src&&(e.src=r.placeholder),t&&r.find&&(t=t.replace(r.find,r.replace)),t||null}}),u={loaded:0,failed:0,next:0,done:0,total:s.length};if(!u.total)return i();var l=e(Array(r.threshold+1).join("<img/>")).load(n).error(n).bind("abort",n).each(o)};t.gap=14,t.cache=[],t.defaults={threshold:2,base:"",ext:"",replace:""},e.fn.preload=function(e){return t(this,e),this}}(jQuery),function(e){function t(t,a,r){var n=a.hash.slice(1),o=document.getElementById(n)||document.getElementsByName(n)[0];if(o){t&&t.preventDefault();var i=e(r.target);if(!(r.lock&&i.is(":animated")||r.onBefore&&r.onBefore.call(r,t,o,i)===!1)){if(r.stop&&i.stop(!0),r.hash){var s=o.id==n?"id":"name",u=e("<a> </a>").attr(s,n).css({position:"absolute",top:e(window).scrollTop(),left:e(window).scrollLeft()});o[s]="",e("body").prepend(u),location=a.hash,u.remove(),o[s]=n}i.scrollTo(o,r).trigger("notify.serialScroll",[o])}}}var a=location.href.replace(/#.*/,""),r=e.localScroll=function(t){e("body").localScroll(t)};r.defaults={duration:1e3,axis:"y",event:"click",stop:!0,target:window,reset:!0},r.hash=function(a){if(location.hash){if(a=e.extend({},r.defaults,a),a.hash=!1,a.reset){var n=a.duration;delete a.duration,e(a.target).scrollTo(0,a),a.duration=n}t(0,location,a)}},e.fn.localScroll=function(n){function o(){return!(!this.href||!this.hash||this.href.replace(this.hash,"")!=a||n.filter&&!e(this).is(n.filter))}return n=e.extend({},r.defaults,n),n.lazy?this.bind(n.event,function(a){var r=e([a.target,a.target.parentNode]).filter(o)[0];r&&t(a,r,n)}):this.find("a,area").filter(o).bind(n.event,function(e){t(e,this,n)}).end().end()}}(jQuery),function(e){function t(e){return"object"==typeof e?e:{top:e,left:e}}var a=e.scrollTo=function(t,a,r){e(window).scrollTo(t,a,r)};a.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1},a.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,a=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!a)return t;var r=(t.contentWindow||t).document||t.ownerDocument||t;return e.browser.safari||"BackCompat"==r.compatMode?r.body:r.documentElement})},e.fn.scrollTo=function(r,n,o){return"object"==typeof n&&(o=n,n=0),"function"==typeof o&&(o={onAfter:o}),"max"==r&&(r=9e9),o=e.extend({},a.defaults,o),n=n||o.speed||o.duration,o.queue=o.queue&&o.axis.length>1,o.queue&&(n/=2),o.offset=t(o.offset),o.over=t(o.over),this._scrollable().each(function(){function i(e){l.animate(d,n,o.easing,e&&function(){e.call(this,r,o)})}var s,u=this,l=e(u),c=r,d={},f=l.is("html,body");switch(typeof c){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(c)){c=t(c);break}c=e(c,this);case"object":(c.is||c.style)&&(s=(c=e(c)).offset())}e.each(o.axis.split(""),function(e,t){var r="x"==t?"Left":"Top",n=r.toLowerCase(),h="scroll"+r,p=u[h],g=a.max(u,t);if(s)d[h]=s[n]+(f?0:p-l.offset()[n]),o.margin&&(d[h]-=parseInt(c.css("margin"+r))||0,d[h]-=parseInt(c.css("border"+r+"Width"))||0),d[h]+=o.offset[n]||0,o.over[n]&&(d[h]+=c["x"==t?"width":"height"]()*o.over[n]);else{var y=c[n];d[h]=y.slice&&"%"==y.slice(-1)?parseFloat(y)/100*g:y}/^\d+$/.test(d[h])&&(d[h]=d[h]<=0?0:Math.min(d[h],g)),!e&&o.queue&&(p!=d[h]&&i(o.onAfterFirst),delete d[h])}),i(o.onAfter)}).end()},a.max=function(t,a){var r="x"==a?"Width":"Height",n="scroll"+r;if(!e(t).is("html,body"))return t[n]-e(t)[r.toLowerCase()]();var o="client"+r,i=t.ownerDocument.documentElement,s=t.ownerDocument.body;return Math.max(i[n],s[n])-Math.min(i[o],s[o])}}(jQuery),window.JSON||(window.JSON={}),function(){function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var a,r,n,o,i,s=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(u)){for(o=u.length,a=0;o>a;a+=1)i[a]=str(a,u)||"null";return n=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+s+"]":"["+i.join(",")+"]",gap=s,n}if(rep&&"object"==typeof rep)for(o=rep.length,a=0;o>a;a+=1)r=rep[a],"string"==typeof r&&(n=str(r,u),n&&i.push(quote(r)+(gap?": ":":")+n));else for(r in u)Object.hasOwnProperty.call(u,r)&&(n=str(r,u),n&&i.push(quote(r)+(gap?": ":":")+n));return n=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+s+"}":"{"+i.join(",")+"}",gap=s,n}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,a){var r;if(gap="",indent="","number"==typeof a)for(r=0;a>r;r+=1)indent+=" ";else"string"==typeof a&&(indent=a);if(rep=t,!t||"function"==typeof t||"object"==typeof t&&"number"==typeof t.length)return str("",{"":e});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var a,r,n=e[t];if(n&&"object"==typeof n)for(a in n)Object.hasOwnProperty.call(n,a)&&(r=walk(n,a),void 0!==r?n[a]=r:delete n[a]);return reviver.call(e,t,n)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e,t){"use strict";var a=e.History=e.History||{},r=e.jQuery;if("undefined"!=typeof a.Adapter)throw new Error("History.js Adapter has already been loaded...");a.Adapter={bind:function(e,t,a){r(e).bind(t,a)},trigger:function(e,t,a){r(e).trigger(t,a)},extractEventData:function(e,a,r){var n=a&&a.originalEvent&&a.originalEvent[e]||r&&r[e]||t;return n},onDomLoad:function(e){r(e)}},"undefined"!=typeof a.init&&a.init()}(window),function(e){"use strict";var t=e.document,a=e.setTimeout||a,r=e.clearTimeout||r,n=e.setInterval||n,o=e.History=e.History||{};if("undefined"!=typeof o.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){return"undefined"!=typeof o.initHtml4.initialized?!1:(o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t,a=o.getHashByIndex();return t=e===a},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return t="undefined"==typeof e?o.savedHashes[o.savedHashes.length-1]:0>e?o.savedHashes[o.savedHashes.length+e]:o.savedHashes[e]},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,a){var r,n=o.getHashByState(e);return r={discardedState:e,backState:a,forwardState:t},o.discardedStates[n]=r,!0},o.discardHash=function(e,t,a){var r={discardedHash:e,backState:a,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t,a=o.getHashByState(e);return t=o.discardedStates[a]||!1},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var a,r,i,s,u="";return o.isInternetExplorer()?(a="historyjs-iframe",r=t.createElement("iframe"),r.setAttribute("id",a),r.style.display="none",t.body.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.close(),i="",s=!1,o.checkerFunction=function(){if(s)return!1;s=!0;var t=o.getHash()||"",a=o.unescapeHash(r.contentWindow.document.location.hash)||"";return t!==u?(u=t,a!==t&&(i=a=t,r.contentWindow.document.open(),r.contentWindow.document.close(),r.contentWindow.document.location.hash=o.escapeHash(t)),o.Adapter.trigger(e,"hashchange")):a!==i&&(i=a,o.setHash(a,!1)),s=!1,!0}):o.checkerFunction=function(){var t=o.getHash();return t!==u&&(u=t,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(n(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(a){var r,n=a&&a.newURL||t.location.href,i=o.getHashByUrl(n),s=null,u=null;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(s=o.extractState(o.getFullUrl(i||t.location.href,!1),!0),o.isLastSavedState(s)?(o.busy(!1),!1):(u=o.getHashByState(s),r=o.discardedState(s),r?(o.getHashByIndex(-2)===o.getHashByState(r.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(s.data,s.title,s.url,!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(a,r,n,i){if(o.getHashByUrl(n))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:i}),!1;o.busy(!0);var s=o.createStateObject(a,r,n),u=o.getHashByState(s),l=o.getState(!1),c=o.getHashByState(l),d=o.getHash();return o.storeState(s),o.expectedStateId=s.id,o.recycleState(s),o.setTitle(s),u===c?(o.busy(!1),!1):u!==d&&u!==o.getShortUrl(t.location.href)?(o.setHash(u,!1),!1):(o.saveState(s),o.Adapter.trigger(e,"statechange"),o.busy(!1),!0)},o.replaceState=function(e,t,a,r){if(o.getHashByUrl(a))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(r!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:r}),!1;o.busy(!0);var n=o.createStateObject(e,t,a),i=o.getState(!1),s=o.getStateByIndex(-2);return o.discardState(i,n,s),o.pushState(n.data,n.title,n.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")}),void 0)},"undefined"!=typeof o.init&&o.init()}(window),function(e,t){"use strict";var a=e.console||t,r=e.document,n=e.navigator,o=e.sessionStorage||!1,i=e.setTimeout,s=e.clearTimeout,u=e.setInterval,l=e.clearInterval,c=e.JSON,d=e.alert,f=e.History=e.History||{},h=e.history;if(c.stringify=c.stringify||c.encode,c.parse=c.parse||c.decode,"undefined"!=typeof f.init)throw new Error("History.js Core has already been loaded...");f.init=function(){return"undefined"==typeof f.Adapter?!1:("undefined"!=typeof f.initCore&&f.initCore(),"undefined"!=typeof f.initHtml4&&f.initHtml4(),!0)},f.initCore=function(){if("undefined"!=typeof f.initCore.initialized)return!1;if(f.initCore.initialized=!0,f.options=f.options||{},f.options.hashChangeInterval=f.options.hashChangeInterval||100,f.options.safariPollInterval=f.options.safariPollInterval||500,f.options.doubleCheckInterval=f.options.doubleCheckInterval||500,f.options.storeInterval=f.options.storeInterval||1e3,f.options.busyDelay=f.options.busyDelay||250,f.options.debug=f.options.debug||!1,f.options.initialTitle=f.options.initialTitle||r.title,f.intervalList=[],f.clearAllIntervals=function(){var e,t=f.intervalList;if("undefined"!=typeof t&&null!==t){for(e=0;e<t.length;e++)l(t[e]);f.intervalList=null}},f.debug=function(){(f.options.debug||!1)&&f.log.apply(f,arguments)},f.log=function(){var e,t,n,o,i,s="undefined"!=typeof a&&"undefined"!=typeof a.log&&"undefined"!=typeof a.log.apply,u=r.getElementById("log");for(s?(o=Array.prototype.slice.call(arguments),e=o.shift(),"undefined"!=typeof a.debug?a.debug.apply(a,[e,o]):a.log.apply(a,[e,o])):e="\n"+arguments[0]+"\n",t=1,n=arguments.length;n>t;++t){if(i=arguments[t],"object"==typeof i&&"undefined"!=typeof c)try{i=c.stringify(i)}catch(l){}e+="\n"+i+"\n"}return u?(u.value+=e+"\n-----\n",u.scrollTop=u.scrollHeight-u.clientHeight):s||d(e),!0},f.getInternetExplorerMajorVersion=function(){var e=f.getInternetExplorerMajorVersion.cached="undefined"!=typeof f.getInternetExplorerMajorVersion.cached?f.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=r.createElement("div"),a=t.getElementsByTagName("i");(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&a[0];);return e>4?e:!1}();return e},f.isInternetExplorer=function(){var e=f.isInternetExplorer.cached="undefined"!=typeof f.isInternetExplorer.cached?f.isInternetExplorer.cached:Boolean(f.getInternetExplorerMajorVersion());return e},f.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(n.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(n.userAgent)),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in r)||f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8)},f.enabled=!f.emulated.pushState,f.bugs={setHash:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===n.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),safariPoll:Boolean(!f.emulated.pushState&&"Apple Computer, Inc."===n.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(n.userAgent)),ieDoubleCheck:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(f.isInternetExplorer()&&f.getInternetExplorerMajorVersion()<7)},f.isEmptyObject=function(e){for(var t in e)return!1;return!0},f.cloneObject=function(e){var t,a;return e?(t=c.stringify(e),a=c.parse(t)):a={},a},f.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);return r.location.port&&(e+=":"+r.location.port),e+="/"},f.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,a="";return 1===e.length&&(t=e[0],a=t.href.replace(/[^\/]+$/,"")),a=a.replace(/\/+$/,""),a&&(a+="/"),a},f.getBaseUrl=function(){var e=f.getBaseHref()||f.getBasePageUrl()||f.getRootUrl();return e},f.getPageUrl=function(){var e,t=f.getState(!1,!1),a=(t||{}).url||r.location.href;return e=a.replace(/\/+$/,"").replace(/[^\/]+$/,function(e){return/\./.test(e)?e:e+"/"})},f.getBasePageUrl=function(){var e=r.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},f.getFullUrl=function(e,t){var a=e,r=e.substring(0,1);return t="undefined"==typeof t?!0:t,/[a-z]+\:\/\//.test(e)||(a="/"===r?f.getRootUrl()+e.replace(/^\/+/,""):"#"===r?f.getPageUrl().replace(/#.*/,"")+e:"?"===r?f.getPageUrl().replace(/[\?#].*/,"")+e:t?f.getBaseUrl()+e.replace(/^(\.\/)+/,""):f.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),a.replace(/\#$/,"")},f.getShortUrl=function(e){var t=e,a=f.getBaseUrl(),r=f.getRootUrl();return f.emulated.pushState&&(t=t.replace(a,"")),t=t.replace(r,"/"),f.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},f.store={},f.idToState=f.idToState||{},f.stateToId=f.stateToId||{},f.urlToId=f.urlToId||{},f.storedStates=f.storedStates||[],f.savedStates=f.savedStates||[],f.normalizeStore=function(){f.store.idToState=f.store.idToState||{},f.store.urlToId=f.store.urlToId||{},f.store.stateToId=f.store.stateToId||{}},f.getState=function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t=!0);var a=f.getLastSavedState();return!a&&t&&(a=f.createStateObject()),e&&(a=f.cloneObject(a),a.url=a.cleanUrl||a.url),a},f.getIdByState=function(e){var t,a=f.extractId(e.url);if(!a)if(t=f.getStateString(e),"undefined"!=typeof f.stateToId[t])a=f.stateToId[t];else if("undefined"!=typeof f.store.stateToId[t])a=f.store.stateToId[t];else{for(;a=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof f.idToState[a]||"undefined"!=typeof f.store.idToState[a];);f.stateToId[t]=a,f.idToState[a]=e}return a},f.normalizeState=function(e){var t,a;return e&&"object"==typeof e||(e={}),"undefined"!=typeof e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),t={},t.normalized=!0,t.title=e.title||"",t.url=f.getFullUrl(f.unescapeString(e.url||r.location.href)),t.hash=f.getShortUrl(t.url),t.data=f.cloneObject(e.data),t.id=f.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,a=!f.isEmptyObject(t.data),(t.title||a)&&(t.hash=f.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=f.getFullUrl(t.hash),(f.emulated.pushState||f.bugs.safariPoll)&&f.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},f.createStateObject=function(e,t,a){var r={data:e,title:t,url:a};return r=f.normalizeState(r)},f.getStateById=function(e){e=String(e);var a=f.idToState[e]||f.store.idToState[e]||t;return a},f.getStateString=function(e){var t,a,r;return t=f.normalizeState(e),a={data:t.data,title:e.title,url:e.url},r=c.stringify(a)},f.getStateId=function(e){var t,a;return t=f.normalizeState(e),a=t.id},f.getHashByState=function(e){var t,a;return t=f.normalizeState(e),a=t.hash},f.extractId=function(e){var t,a,r;return a=/(.*)\&_suid=([0-9]+)$/.exec(e),r=a?a[1]||e:e,t=a?String(a[2]||""):"",t||!1},f.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},f.extractState=function(e,t){var a,r,n=null;return t=t||!1,a=f.extractId(e),a&&(n=f.getStateById(a)),n||(r=f.getFullUrl(e),a=f.getIdByUrl(r)||!1,a&&(n=f.getStateById(a)),!n&&t&&!f.isTraditionalAnchor(e)&&(n=f.createStateObject(null,null,r))),n},f.getIdByUrl=function(e){var a=f.urlToId[e]||f.store.urlToId[e]||t;return a},f.getLastSavedState=function(){return f.savedStates[f.savedStates.length-1]||t},f.getLastStoredState=function(){return f.storedStates[f.storedStates.length-1]||t},f.hasUrlDuplicate=function(e){var t,a=!1;return t=f.extractState(e.url),a=t&&t.id!==e.id},f.storeState=function(e){return f.urlToId[e.url]=e.id,f.storedStates.push(f.cloneObject(e)),e},f.isLastSavedState=function(e){var t,a,r,n=!1;return f.savedStates.length&&(t=e.id,a=f.getLastSavedState(),r=a.id,n=t===r),n},f.saveState=function(e){return f.isLastSavedState(e)?!1:(f.savedStates.push(f.cloneObject(e)),!0)},f.getStateByIndex=function(e){var t=null;return t="undefined"==typeof e?f.savedStates[f.savedStates.length-1]:0>e?f.savedStates[f.savedStates.length+e]:f.savedStates[e]},f.getHash=function(){var e=f.unescapeHash(r.location.hash);return e},f.unescapeString=function(t){for(var a,r=t;a=e.unescape(r),a!==r;)r=a;return r},f.unescapeHash=function(e){var t=f.normalizeHash(e);return t=f.unescapeString(t)},f.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},f.setHash=function(e,t){var a,n,o;return t!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.setHash,args:arguments,queue:t}),!1):(a=f.escapeHash(e),f.busy(!0),n=f.extractState(e,!0),n&&!f.emulated.pushState?f.pushState(n.data,n.title,n.url,!1):r.location.hash!==a&&(f.bugs.setHash?(o=f.getPageUrl(),f.pushState(null,null,o+"#"+a,!1)):r.location.hash=a),f)},f.escapeHash=function(t){var a=f.normalizeHash(t);return a=e.escape(a),f.bugs.hashEscape||(a=a.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),a},f.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=f.unescapeHash(t)},f.setTitle=function(e){var t,a=e.title;a||(t=f.getStateByIndex(0),t&&t.url===e.url&&(a=t.title||f.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=a.replace("<","&lt;").replace(">","&gt;").replace(" & "," & ")}catch(n){}return r.title=a,f},f.queues=[],f.busy=function(e){if("undefined"!=typeof e?f.busy.flag=e:"undefined"==typeof f.busy.flag&&(f.busy.flag=!1),!f.busy.flag){s(f.busy.timeout);var t=function(){var e,a,r;if(!f.busy.flag)for(e=f.queues.length-1;e>=0;--e)a=f.queues[e],0!==a.length&&(r=a.shift(),f.fireQueueItem(r),f.busy.timeout=i(t,f.options.busyDelay))};f.busy.timeout=i(t,f.options.busyDelay)}return f.busy.flag},f.busy.flag=!1,f.fireQueueItem=function(e){return e.callback.apply(e.scope||f,e.args||[])},f.pushQueue=function(e){return f.queues[e.queue||0]=f.queues[e.queue||0]||[],f.queues[e.queue||0].push(e),f},f.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),"undefined"!=typeof t&&(e.queue=t),f.busy()?f.pushQueue(e):f.fireQueueItem(e),f},f.clearQueue=function(){return f.busy.flag=!1,f.queues=[],f},f.stateChanged=!1,f.doubleChecker=!1,f.doubleCheckComplete=function(){return f.stateChanged=!0,f.doubleCheckClear(),f},f.doubleCheckClear=function(){return f.doubleChecker&&(s(f.doubleChecker),f.doubleChecker=!1),f},f.doubleCheck=function(e){return f.stateChanged=!1,f.doubleCheckClear(),f.bugs.ieDoubleCheck&&(f.doubleChecker=i(function(){return f.doubleCheckClear(),f.stateChanged||e(),!0},f.options.doubleCheckInterval)),f},f.safariStatePoll=function(){var t,a=f.extractState(r.location.href);if(!f.isLastSavedState(a))return t=a,t||(t=f.createStateObject()),f.Adapter.trigger(e,"popstate"),f},f.back=function(e){return e!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.back,args:arguments,queue:e}),!1):(f.busy(!0),f.doubleCheck(function(){f.back(!1)}),h.go(-1),!0)},f.forward=function(e){return e!==!1&&f.busy()?(f.pushQueue({scope:f,callback:f.forward,args:arguments,queue:e}),!1):(f.busy(!0),f.doubleCheck(function(){f.forward(!1)}),h.go(1),!0)},f.go=function(e,t){var a;if(e>0)for(a=1;e>=a;++a)f.forward(t);else{if(!(0>e))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(a=-1;a>=e;--a)f.back(t)}return f},f.emulated.pushState){var p=function(){};f.pushState=f.pushState||p,f.replaceState=f.replaceState||p}else f.onPopState=function(t,a){var n,o,i=!1,s=!1;return f.doubleCheckComplete(),n=f.getHash(),n?(o=f.extractState(n||r.location.href,!0),o?f.replaceState(o.data,o.title,o.url,!1):(f.Adapter.trigger(e,"anchorchange"),f.busy(!1)),f.expectedStateId=!1,!1):(i=f.Adapter.extractEventData("state",t,a)||!1,s=i?f.getStateById(i):f.expectedStateId?f.getStateById(f.expectedStateId):f.extractState(r.location.href),s||(s=f.createStateObject(null,null,r.location.href)),f.expectedStateId=!1,f.isLastSavedState(s)?(f.busy(!1),!1):(f.storeState(s),f.saveState(s),f.setTitle(s),f.Adapter.trigger(e,"statechange"),f.busy(!1),!0))},f.Adapter.bind(e,"popstate",f.onPopState),f.pushState=function(t,a,r,n){if(f.getHashByUrl(r)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.pushState,args:arguments,queue:n}),!1;f.busy(!0);var o=f.createStateObject(t,a,r);return f.isLastSavedState(o)?f.busy(!1):(f.storeState(o),f.expectedStateId=o.id,h.pushState(o.id,o.title,o.url),f.Adapter.trigger(e,"popstate")),!0},f.replaceState=function(t,a,r,n){if(f.getHashByUrl(r)&&f.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(n!==!1&&f.busy())return f.pushQueue({scope:f,callback:f.replaceState,args:arguments,queue:n}),!1;f.busy(!0);var o=f.createStateObject(t,a,r);return f.isLastSavedState(o)?f.busy(!1):(f.storeState(o),f.expectedStateId=o.id,h.replaceState(o.id,o.title,o.url),f.Adapter.trigger(e,"popstate")),!0};if(o){try{f.store=c.parse(o.getItem("History.store"))||{}}catch(g){f.store={}}f.normalizeStore()}else f.store={},f.normalizeStore();f.Adapter.bind(e,"beforeunload",f.clearAllIntervals),f.Adapter.bind(e,"unload",f.clearAllIntervals),f.saveState(f.storeState(f.extractState(r.location.href,!0))),o&&(f.onUnload=function(){var e,t;try{e=c.parse(o.getItem("History.store"))||{}}catch(a){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in f.idToState)f.idToState.hasOwnProperty(t)&&(e.idToState[t]=f.idToState[t]);for(t in f.urlToId)f.urlToId.hasOwnProperty(t)&&(e.urlToId[t]=f.urlToId[t]);for(t in f.stateToId)f.stateToId.hasOwnProperty(t)&&(e.stateToId[t]=f.stateToId[t]);f.store=e,f.normalizeStore(),o.setItem("History.store",c.stringify(e))},f.intervalList.push(u(f.onUnload,f.options.storeInterval)),f.Adapter.bind(e,"beforeunload",f.onUnload),f.Adapter.bind(e,"unload",f.onUnload)),f.emulated.pushState||(f.bugs.safariPoll&&f.intervalList.push(u(f.safariStatePoll,f.options.safariPollInterval)),("Apple Computer, Inc."===n.vendor||"Mozilla"===(n.appCodeName||""))&&(f.Adapter.bind(e,"hashchange",function(){f.Adapter.trigger(e,"popstate")}),f.getHash()&&f.Adapter.onDomLoad(function(){f.Adapter.trigger(e,"hashchange")})))},f.init()}(window);